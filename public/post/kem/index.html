
<!DOCTYPE html>
<html lang="en-us">
<head>

  
  <meta charset="UTF-8">
  <title>
    rsa-based key encapsulation mechanisms | kel.bz
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">

  
  <link rel="canonical" href="https://kel.bz/post/kem/"/>

  
  <link rel="stylesheet" href="/css/sanitize.css">
  <link rel="stylesheet" href="/css/responsive.css">
  <link rel="stylesheet" href="/css/highlight_monokai.css">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/custom.css">
  
  
  <link href="https://kel.bz//index.xml" rel="alternate" type="application/rss+xml" title="kel.bz" />
  <link href="https://kel.bz//index.xml" rel="feed" type="application/rss+xml" title="kel.bz" />

  
  


</head>



<body>
<div class="container">

  
  <header role="banner">
    <div class="row gutters">
      <div id="site-title" class="col span_6">
        <h1><a href="https://kel.bz/">kel.bz</a></h1>
        
      </div>
      <div id="social" class="col span_6">
        <ul>
          <li><a href="/about/me">about kel.bz</a></li>
          <li><a href="https://twitter.com/kelbyludwig" target="_blank">twitter</a></li>
          
          <li><a href="https://github.com/kelbyludwig" target="_blank">github</a></li>
          <li><a href="https://kel.bz//index.xml" type="application/rss+xml" target="_blank">rss</a></li>
        </ul>
      </div>
    </div>
  </header>


  
  <main id="single" role="main">
    <div class="article-header">
      <h1>rsa-based key encapsulation mechanisms</h1>
      <div class="meta">
        May 27, 2019 &nbsp;
        
      </div>
    </div>
    <article>
      <p>A key encapsulation mechanism (KEM) can be used to construct a &ldquo;hybrid&rdquo; cryptosystems. In these cryptosystems symmetric keys (e.g. for AES) are encrypted using asymmetric keys. The symmetric key is used for encrypting data.</p>
<p>A naive KEM built using RSA primitives could use &ldquo;textbook&rdquo; RSA to encrypt a randomly generated symmetric key but this has some significant flaws:</p>
<ul>
<li>
<p>If <code>e</code> is small (e.g. <code>e</code>=3), the symmetric key may not be reduced by the modulus after exponentiation. This means the &ldquo;encrypted&rdquo; key would be trivially decrypted by taking the <code>e</code>th-root of the ciphertext.</p>
</li>
<li>
<p>Unpadded RSA ciphertexts can be manipulated in predicatable ways. The paper <a href="https://arxiv.org/pdf/1802.03367.pdf">&ldquo;When Textbook RSA is Used to Protect the Privacy of Hundreds of Millions of Users&rdquo;</a> describes a fantastic attack on an unpadded RSA-based KEM where captured encrypted keys were decrypted by replaying ciphertexts with clever bit-shifts.</p>
</li>
</ul>
<p>These issues could be alleviated by using a secure padding scheme like <a href="https://cseweb.ucsd.edu/~mihir/papers/oae.pdf">OAEP</a>. However, there is a secure KEM that is just about as simple as the textbook KEM called <a href="https://www.shoup.net/papers/iso-2.pdf">RSA-KEM</a>.</p>
<p>RSA-KEM works by generating a random integer <code>r</code> in <code>(0, N-1)</code> (where <code>N</code> is the modulus of the key) and encrypting/encapsulating <code>r</code>. The symmetric key is then derived by throwing <code>r</code> into a key derivation function (KDF).</p>
<p>As I understand it, OAEP is emulating a construction like RSA-KEM in that it attempts to converts a message into a <code>r</code>-like value. The extra complexity that OAEP introduces is to handle messages that are not necessarily evenly distributed in <code>(0, N-1)</code> and the padding step needs to be reversible.</p>

      
      
      
    </article>
    


  </main>
  
  <nav class="pagination-single">
    
      <span class="previous">&larr; <a href="https://kel.bz/post/entropy/" rel="prev">measures of entropy</a></span>
    
    
      <span class="next"><a href="https://kel.bz/post/designreview/" rel="next">questions for system design reviews</a> &rarr;</span>
    
  </nav>


  
  <footer role="contentinfo">
    <div style="text-align:center;">
      <img src="https://kel.bz/profile.jpg" width="64" height="64"><br>
      written by kelby ludwig
    </div>
  </footer>


</div>

<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</body>
</html>

