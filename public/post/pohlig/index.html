
<!DOCTYPE html>
<html lang="en-us">
<head>

  
  <meta charset="UTF-8">
  <title>
    a note on subgroup confinement attacks | kel.bz
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">

  
  <link rel="canonical" href="https://kel.bz/post/pohlig/"/>

  
  <link rel="stylesheet" href="/css/sanitize.css">
  <link rel="stylesheet" href="/css/responsive.css">
  <link rel="stylesheet" href="/css/highlight_monokai.css">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/custom.css">
  
  
  <link href="https://kel.bz//index.xml" rel="alternate" type="application/rss+xml" title="kel.bz" />
  <link href="https://kel.bz//index.xml" rel="feed" type="application/rss+xml" title="kel.bz" />

  
  


</head>



<body>
<div class="container">

  
  <header role="banner">
    <div class="row gutters">
      <div id="site-title" class="col span_6">
        <h1><a href="https://kel.bz/">kel.bz</a></h1>
        
      </div>
      <div id="social" class="col span_6">
        <ul>
          <li><a href="/about/me">about kel.bz</a></li>
          <li><a href="https://twitter.com/kelbyludwig" target="_blank">twitter</a></li>
          
          <li><a href="https://github.com/kelbyludwig" target="_blank">github</a></li>
          <li><a href="https://kel.bz//index.xml" type="application/rss+xml" target="_blank">rss</a></li>
        </ul>
      </div>
    </div>
  </header>


  
  <main id="single" role="main">
    <div class="article-header">
      <h1>a note on subgroup confinement attacks</h1>
      <div class="meta">
        Jan 14, 2017 &nbsp;
        
      </div>
    </div>
    <article>
      <p>The Pohlig-Hellman algorithm is a efficient method of solving the discrete log
problem for groups whose order is a <code>smooth integer</code>. A smooth integer is just
an integer whose prime factorization consists of small prime numbers.</p>
<p>Pohlig-Hellman could be used to efficiently recover private keys from broken
(EC)DH implementations. There are some cryptopals exercise that use it (its in
set 8). This attack is often referred to as a &ldquo;subgroup confinement&rdquo; attack.
It's really cool. (I do not plan on covering the algorithm here
<a href="https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm">Wikipedia</a> has
a pretty good walkthrough of the algorithm).</p>
<p>Something that initially tripped me up was that subgroup confinement works in
multiple contexts. When looking up the algorithm in most textbooks (or, you
know, Wikipedia) Pohlig-Hellman takes advantage of a single element whose order
is a smooth integer. In other words, we want to solve <code>h = g^x (mod m)</code> with
knowledge of <code>h</code>, <code>g</code>, and <code>m</code>. If the order of <code>g</code> is smooth, we can recover
bits of <code>x</code> with only a single element <code>h</code>. This is the &ldquo;offline&rdquo; case. You
could think of this applying to some packet capture of an awful TLS
implementation for a server that has since been shutdown. If all goes well, just
having access to the pcap could lead to private key recovery.</p>
<p>Another context for subgroup confinement leverages an &ldquo;online&rdquo; oracle. In
this context, the target implementation could accept malicious group elements
<code>g</code> and respond with <code>h = g^x (mod m)</code>. Dependent on the properties of <code>m</code> the
attacker could generate different values for <code>g</code> that make solving for <code>h</code>
easy(ish). This would apply to (for example) a live TLS server that an attacker
is sending evil values to.</p>
<p>When I was initially working on this attack, I was applying an offline
algorithm to an online context. Once I figured out why my code was borked, it
was enlightening to think about subgroup confinement from this &ldquo;multiple
context&rdquo; perspective.</p>

      
      
      
    </article>
    


  </main>
  
  <nav class="pagination-single">
    
      <span class="previous">&larr; <a href="https://kel.bz/post/lll/" rel="prev">building lattice reduction (LLL) intuition</a></span>
    
    
      <span class="next"><a href="https://kel.bz/post/signal/" rel="next">why signal is well-designed</a> &rarr;</span>
    
  </nav>


  
  <footer role="contentinfo">
    <div style="text-align:center;">
      <img src="https://kel.bz/profile.jpg" width="64" height="64"><br>
      written by kelby ludwig
    </div>
  </footer>


</div>

<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</body>
</html>

